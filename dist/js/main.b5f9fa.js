(()=>{"use strict";var t={89:(t,e,o)=>{o.r(e)},317:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createMatrixMap=e.Block=e.BlockType=e.matrix=void 0;const r=o(841);var c;!function(t){t[t.DEFAULT=0]="DEFAULT",t[t.MINE=1]="MINE"}(c=e.BlockType||(e.BlockType={}));class i{constructor(t,e,o,r){this.type=t,this.mineNum=e,this.r=o,this.c=r,this.exhibit=this.flag=!1,this.color="#171617",this.flagFillStyle="#95DCED"}show(t){const{exhibit:o,mineNum:r,r:c,c:i}=this;return o||(t++,this.exhibit=!0,this.flag=!1,0===r&&[[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,1],[0,1],[1,1]].forEach((([o,r])=>{var l;const n=c+r,a=i+o;(null===(l=e.matrix[n])||void 0===l?void 0:l[a])&&!e.matrix[n][a].exhibit&&(t=e.matrix[n][a].show(t))})),this.draw()),t}draw(){const{r:t,c:e,mineNum:o,exhibit:c,flag:i,fillStyle:l,color:n,flagFillStyle:a}=this,s=e*r.w,f=t*r.h;r.ctx.beginPath(),r.ctx.clearRect(s,f,r.w,r.h),r.ctx.strokeRect(s,f,r.w,r.h),c&&l&&(r.ctx.fillStyle=l,r.ctx.fillRect(s,f,r.w,r.h)),r.ctx.textAlign="center",r.ctx.textBaseline="middle",r.ctx.fillStyle=n,o&&r.ctx.fillText(String(o),s+r.w/2,f+r.h/2),c||(r.ctx.fillStyle="#2D3E4A",r.ctx.fillRect(s,f,r.w,r.h)),i&&(r.ctx.fillStyle=a,r.ctx.fillRect(s,f,r.w,r.h)),r.ctx.closePath()}}e.Block=i,e.createMatrixMap=function(){e.matrix=Array.from(new Array(r.row),(()=>[]));let t=~~(r.row*r.col/10+Math.random()*r.row*r.col/10);const o=t;for(;t>0;){const o=~~(Math.random()*r.row),l=~~(Math.random()*r.col);e.matrix[o][l]||(e.matrix[o][l]=new i(c.MINE,"*",o,l),t--)}for(let t=0;t<r.row;++t)for(let o=0;o<r.col;++o)if(!e.matrix[t][o]){const l=[[-1,0],[1,0],[-1,-1],[0,-1],[1,-1],[-1,1],[0,1],[1,1]].filter((([i,l])=>{const n=i+o,a=l+t;return n>=0&&a>=0&&n<r.col&&a<r.row&&e.matrix[a][n]&&e.matrix[a][n].type===c.MINE})).length;e.matrix[t][o]=new i(c.DEFAULT,l,t,o)}return o}},841:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ctx=e.cvs=e.setRowAndCol=e.col=e.row=e.h=e.w=void 0,e.w=20,e.h=20,e.row=10,e.col=10;e.setRowAndCol=t=>e.row=e.col=t,e.cvs=document.querySelector("canvas"),e.ctx=e.cvs.getContext("2d")}},e={};function o(r){var c=e[r];if(void 0!==c)return c.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,o),i.exports}o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};(()=>{o(89);const t=o(317),e=o(841);let r,c,i,l,n=0,a=0,s=0;function f(){c=e.cvs.width=e.w*e.col,i=e.cvs.height=e.h*e.row,n=0,a=0,s=0,n=(0,t.createMatrixMap)(),function(){const o=h(e.cvs,"click",(o=>{const{clientX:c,clientY:i}=o,{offsetLeft:l,offsetTop:f}=e.cvs,h=~~((i-f)/e.h),m=~~((c-l)/e.w),w=t.matrix[h][m],{type:u}=w;u==t.BlockType.MINE?function(e){e.fillStyle="#A705ED",t.matrix.forEach((e=>e.forEach((e=>{const{type:o}=e;o===t.BlockType.MINE&&(e.exhibit=!0,e.flag=!1,e.draw())})))),x()}(w):(0===a&&(r=setInterval((()=>{s++}),1e3)),a=t.matrix[h][m].show(a),setTimeout((()=>{e.row*e.col-a===n&&s&&(alert(`此次游戏耗时: ${s}s`),s=0)})))})),c=h(e.cvs,"contextmenu",(o=>{o.preventDefault();const{clientX:r,clientY:c}=o,{offsetLeft:i,offsetTop:l}=e.cvs,n=~~((c-l)/e.h),a=~~((r-i)/e.w),s=t.matrix[n][a];if(s.exhibit)return!1;s.flag=!s.flag,s.draw()}));l=()=>{c(),o()}}(),function(){e.ctx.clearRect(0,0,c,i);for(let o=0;o<e.row;++o)for(let r=0;r<e.col;++r)t.matrix[o][r].draw()}()}function x(){s=0,clearInterval(r),l()}function h(t,e,o){return t.addEventListener(e,o,!1),()=>t.removeEventListener(e,o,!1)}h(document.querySelector(".mine-sweeping"),"click",(({target:t})=>{let o=Number(t.dataset.level);o&&(s&&!confirm("游戏正在进行中,是否弃掉?")||(o=Math.max(Math.min(o,3),1),(0,e.setRowAndCol)(10*o),x(),f()))})),f()})()})();